@using RegTesting.Contracts
@model IList<TestsystemSummary>

@{
	ViewBag.Title = "Testsystem Übersicht";
}

<div class="page-header">
<h1>
    Pinned branches
</h1>
</div>
<div id="pinnedBranchSummariesBlock">
	@{Html.RenderPartial("MainBranchSummariesPartial", Model);}
</div>

<h3>Last tested branches</h3>
<div id="lastBranchSummariesBlock">
	<div class="alert alert-warning"><h4>Loading ...</h4></div>
</div>


<script type="text/javascript">
$(function () {
	updateLastBranchSummariesTable();
	updatePinnedBranchSummariesTable();

	function updateLastBranchSummariesTable() {
		$.get('@Url.Action("GetThorBranchSummariesTable")', {},
			function (view) {
			    $("div#lastBranchSummariesBlock").html(view);
				setTimeout(function () {
				    updateLastBranchSummariesTable();
				}, 60000);
			});
	}

    function updatePinnedBranchSummariesTable() {
		$.get('@Url.Action("GetThorMainBranchSummaries")', {},
			function (view) {
			    $("div#pinnedBranchSummariesBlock").html(view);
				setTimeout(function () {
				    updatePinnedBranchSummariesTable();
				}, 30000);
			});
	}

});
</script>
